% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model.R
\name{model-method-compile}
\alias{model-method-compile}
\title{Compile a Stan program or get the Stan code}
\description{
The \code{compile} method of a \code{\link{CmdStanModel}} object calls CmdStan
to translate a Stan program to C++ and then create a compiled executable.
The resulting files are placed in the same directory as the Stan program
associated with the \code{CmdStanModel} object.
}
\section{Usage}{
\preformatted{$compile(
  threads = FALSE,
  opencl = FALSE,
  opencl_platform_id = 0,
  opencl_device_id = 0,
  compiler_flags = NULL
)
}
}

\section{Arguments for the \code{compile} method}{

Leaving all arguments at their defaults should be fine for most users, but
optional arguments are provided to enable new features in CmdStan (and the
Stan Math library). See the CmdStan manual for more details.
\itemize{
\item \code{threads}: (logical) Should the model be compiled with
\href{https://github.com/stan-dev/math/wiki/Threading-Support}{threading support}?
If \code{TRUE} then \code{-DSTAN_THREADS} is added to the compiler flags. See
\code{\link[=set_num_threads]{set_num_threads()}} to set the number of threads, which is read by
CmdStan at run-time from an environment variable.
\item \code{opencl}: (logical) Should the model be compiled with OpenCL support enabled?
\item \code{opencl_platform_id}: (nonnegative integer) The ID of the OpenCL platform on which
to run the compiled model.
\item \code{opencl_device_id}: (nonnegative integer) The ID of the OpenCL device on the selected
OpenCL platform on which to run the compiled model.
\item \code{compiler_flags}: (character vector) Any additional compiler flags to be
used when compiling the model.
}
}

\section{Value}{
 This method is called for its side effect of creating the
executable and adding its path to the \code{\link{CmdStanModel}} object, but it also
returns the \code{\link{CmdStanModel}} object invisibly. After compilation the path
to the executable can be accesed via \code{$exe_file()}.
}

\examples{
\dontrun{
# Set path to cmdstan
# Note: if you installed CmdStan via install_cmdstan() with default settings
# then default below should work. Otherwise use the `path` argument to
# specify the location of your CmdStan installation.

set_cmdstan_path(path = NULL)

# Create a CmdStan model object from a Stan program,
# here using the example model that comes with CmdStan
stan_program <- file.path(cmdstan_path(), "examples/bernoulli/bernoulli.stan")
mod <- cmdstan_model(stan_program)
mod$print()

# Compile to create executable
mod$compile()

# Run sample method (MCMC via Stan's dynamic HMC/NUTS),
# specifying data as a named list (like RStan)
standata <- list(N = 10, y =c(0,1,0,0,0,0,0,0,0,1))
fit_mcmc <- mod$sample(data = standata, seed = 123, num_chains = 2)

# Call CmdStan's bin/summary
fit_mcmc$summary()

# Run optimization method (default is Stan's LBFGS algorithm)
# and also demonstrate specifying data as a path to a file (readable by CmdStan)
my_data_file <- file.path(cmdstan_path(), "examples/bernoulli/bernoulli.data.R")
fit_optim <- mod$optimize(data = my_data_file, seed = 123)

#' Print estimates
fit_optim$summary()

# Run variational Bayes method (default is meanfield ADVI)
fit_vb <- mod$variational(data = standata, seed = 123)

# Call CmdStan's bin/summary
fit_vb$summary()

# For models fit using MCMC, if you like working with RStan's stanfit objects
# then you can create one with rstan::read_stan_csv()
if (require(rstan, quietly = TRUE)) {
  stanfit <- rstan::read_stan_csv(fit_mcmc$output_files())
  print(stanfit)
}

}

}
\seealso{
The CmdStanR website (\href{https://mc-stan.org/cmdstanr/}{mc-stan.org/cmdstanr})
for online documentation and tutorials.

The Stan and CmdStan documentation:
\itemize{
\item Stan doc (html or pdf): \href{https://mc-stan.org/users/documentation/}{mc-stan.org/users/documentation/}
\item CmdStan doc (pdf): (\href{https://github.com/stan-dev/cmdstan/releases/latest}{github.com/stan-dev/cmdstan/releases/}).
}

Other CmdStanModel methods: \code{\link{model-method-optimize}},
  \code{\link{model-method-sample}},
  \code{\link{model-method-variational}}
}
\concept{CmdStanModel methods}
