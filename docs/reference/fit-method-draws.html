<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract posterior draws — fit-method-draws • cmdstanr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extract posterior draws — fit-method-draws" />
<meta property="og:description" content="Extract posterior draws after MCMC or approximate posterior
draws after variational approximation using formats provided by the
posterior package.
The variables include the parameters, transformed parameters, and
generated quantities from the Stan program as well as lp__, the total
log probability (target) accumulated in the model block." />
<meta property="og:image" content="https://mc-stan.org/cmdstanr/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cmdstanr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/cmdstanr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract posterior draws</h1>
    <small class="dont-index">Source: <a href='https://github.com/stan-dev/cmdstanr/blob/master/R/fit.R'><code>R/fit.R</code></a></small>
    <div class="hidden name"><code>fit-method-draws.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract posterior draws after MCMC or approximate posterior
draws after variational approximation using formats provided by the
<span class="pkg">posterior</span> package.</p>
<p>The variables include the <code>parameters</code>, <code>transformed parameters</code>, and
<code>generated quantities</code> from the Stan program as well as <code>lp__</code>, the total
log probability (<code>target</code>) accumulated in the <code>model</code> block.</p>
    </div>



    <h2 class="hasAnchor" id="usage"><a class="anchor" href="#usage"></a>Usage</h2>

    
<pre>$draws(variables = NULL, inc_warmup = FALSE, ...)
</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>

    

<ul>
<li><p><code>variables</code>: (character vector) The variables (parameters and generated
quantities) to read in. If <code>NULL</code> (the default) then the draws of all
variables are included.</p></li>
<li><p><code>inc_warmup</code>: (logical) For MCMC only, should warmup draws be included?
Defaults to <code>FALSE</code>.</p></li>
<li><p><code>...</code>: Arguments passed on to <code><a href='https://rdrr.io/pkg/posterior/man/draws.html'>posterior::as_draws()</a></code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<ul>
<li><p>For MCMC, a 3-D <code><a href='https://rdrr.io/pkg/posterior/man/draws_array.html'>draws_array</a></code> object (iteration x
chain x variable).</p></li>
<li><p>For variational inference, a 2-D <code><a href='https://rdrr.io/pkg/posterior/man/draws_matrix.html'>draws_matrix</a></code>
object (draw x variable). An additional variable <code>lp_approx__</code> is also
included, which is the log density of the variational approximation to the
posterior evaluated at each of the draws.</p></li>
<li><p>For optimization, a 1-row <code><a href='https://rdrr.io/pkg/posterior/man/draws_matrix.html'>draws_matrix</a></code> with
one column per variable. These are <em>not</em> actually draws, just point estimates
stored in the <code>draws_matrix</code> format.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontrun{</span>
<span class='no'>stan_program</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>(<span class='kw'>fileext</span><span class='kw'>=</span><span class='st'>".stan"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span>(<span class='st'>"
parameters {
  real&lt;lower=0&gt; alpha;
  vector[6] beta;
}
model {
 alpha ~ exponential(1);
 beta ~ std_normal();
}
"</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='no'>stan_program</span>)

<span class='co'># only using capture.output to avoid too much printed output in example</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>utils</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/capture.output.html'>capture.output</a></span>(
  <span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cmdstan_model.html'>cmdstan_model</a></span>(<span class='no'>stan_program</span>),
  <span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span>$<span class='fu'><a href='model-method-sample.html'>sample</a></span>(<span class='kw'>save_warmup</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
)</div><div class='output co'>#&gt; <span class='message'>Compiling Stan program...</span></div><div class='input'>
<span class='co'># returned as 3-D array (see ?posterior::draws_array)</span>
<span class='no'>draws</span> <span class='kw'>&lt;-</span> <span class='no'>fit</span>$<span class='fu'>draws</span>()
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='no'>draws</span>)</div><div class='output co'>#&gt; [1] 1000    4    8</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>draws</span>)</div><div class='output co'>#&gt;  'draws_array' num [1:1000, 1:4, 1:8] -4.61 -3.21 -3.09 -9.81 -8.23 ...
#&gt;  - attr(*, "dimnames")=List of 3
#&gt;   ..$ iteration: chr [1:1000] "1" "2" "3" "4" ...
#&gt;   ..$ chain    : chr [1:4] "1" "2" "3" "4"
#&gt;   ..$ variable : chr [1:8] "lp__" "alpha" "beta[1]" "beta[2]" ...</div><div class='input'>
<span class='co'># can easily convert to other formats that have chains combined,</span>
<span class='co'># e.g. matrix, data frame, list</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='st'>"posterior"</span>)
<span class='no'>draws</span> <span class='kw'>&lt;-</span> <span class='no'>fit</span>$<span class='fu'>draws</span>()
<span class='fu'><a href='https://rdrr.io/pkg/posterior/man/draws_matrix.html'>as_draws_matrix</a></span>(<span class='no'>draws</span>)</div><div class='output co'>#&gt; # A draws_matrix: 4000 draws, and 8 variables
#&gt;     variable
#&gt; draw lp__ alpha beta[1] beta[2] beta[3] beta[4] beta[5] beta[6]
#&gt;   1  -4.6 0.356    0.18  -0.865  -1.657    1.30  -0.349   1.052
#&gt;   2  -3.2 0.182    0.67   0.356  -0.844    0.62  -0.093  -0.986
#&gt;   3  -3.1 1.980   -1.15  -0.089  -0.120   -1.48  -0.174   0.126
#&gt;   4  -9.8 0.057    2.02   0.618   0.444   -2.58  -1.273   0.901
#&gt;   5  -8.2 1.837   -1.94  -0.835   0.735    2.78   1.026  -0.494
#&gt;   6  -8.5 0.472    0.37  -0.299  -0.693   -3.44  -1.451   0.033
#&gt;   7  -7.3 0.371   -1.07   1.063   0.394    2.65   1.502  -0.471
#&gt;   8  -8.2 0.182    1.36   2.491  -0.183    0.66  -1.281  -1.559
#&gt;   9  -6.4 0.363   -1.32  -2.461   0.055   -0.64   1.165   0.680
#&gt;   10 -2.4 1.757    1.20   0.126  -0.101    0.52  -0.432  -0.759
#&gt; # ... with 3990 more draws</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/posterior/man/draws_df.html'>as_draws_df</a></span>(<span class='no'>draws</span>)</div><div class='output co'>#&gt; # A draws_df: 1000 iterations, 4 chains, and 8 variables
#&gt;    lp__ alpha beta[1] beta[2] beta[3] beta[4] beta[5] beta[6]
#&gt; 1  -4.6 0.356    0.18  -0.865  -1.657    1.30  -0.349   1.052
#&gt; 2  -3.2 0.182    0.67   0.356  -0.844    0.62  -0.093  -0.986
#&gt; 3  -3.1 1.980   -1.15  -0.089  -0.120   -1.48  -0.174   0.126
#&gt; 4  -9.8 0.057    2.02   0.618   0.444   -2.58  -1.273   0.901
#&gt; 5  -8.2 1.837   -1.94  -0.835   0.735    2.78   1.026  -0.494
#&gt; 6  -8.5 0.472    0.37  -0.299  -0.693   -3.44  -1.451   0.033
#&gt; 7  -7.3 0.371   -1.07   1.063   0.394    2.65   1.502  -0.471
#&gt; 8  -8.2 0.182    1.36   2.491  -0.183    0.66  -1.281  -1.559
#&gt; 9  -6.4 0.363   -1.32  -2.461   0.055   -0.64   1.165   0.680
#&gt; 10 -2.4 1.757    1.20   0.126  -0.101    0.52  -0.432  -0.759
#&gt; # ... with 3990 more draws
#&gt; # ... hidden meta-columns {'.chain', '.iteration', '.draw'}</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/posterior/man/draws_list.html'>as_draws_list</a></span>(<span class='no'>draws</span>)</div><div class='output co'>#&gt; # A draws_list: 1000 iterations, 4 chains, and 8 variables
#&gt; 
#&gt; [chain = 1]
#&gt; $lp__
#&gt;  [1] -4.6 -3.2 -3.1 -9.8 -8.2 -8.5 -7.3 -8.2 -6.4 -2.4
#&gt; 
#&gt; $alpha
#&gt;  [1] 0.356 0.182 1.980 0.057 1.837 0.472 0.371 0.182 0.363 1.757
#&gt; 
#&gt; $`beta[1]`
#&gt;  [1]  0.18  0.67 -1.15  2.02 -1.94  0.37 -1.07  1.36 -1.32  1.20
#&gt; 
#&gt; $`beta[2]`
#&gt;  [1] -0.865  0.356 -0.089  0.618 -0.835 -0.299  1.063  2.491 -2.461  0.126
#&gt; 
#&gt; 
#&gt; [chain = 2]
#&gt; $lp__
#&gt;  [1]  -4.8 -10.4  -3.6  -2.4  -5.3  -2.1  -3.0  -3.7  -3.2  -3.7
#&gt; 
#&gt; $alpha
#&gt;  [1] 0.648 0.069 0.735 1.105 0.688 0.619 0.825 0.236 2.181 0.170
#&gt; 
#&gt; $`beta[1]`
#&gt;  [1]  0.039  2.356 -0.742  0.857  0.574  0.708 -0.802 -1.351  0.165  0.126
#&gt; 
#&gt; $`beta[2]`
#&gt;  [1]  1.23 -0.26 -1.28 -1.12 -1.76 -0.79 -0.26 -0.36 -0.52  0.59
#&gt; 
#&gt; # ... with 990 more iterations, and 2 more chains, and 4 more variables</div><div class='input'>
<span class='co'># can select specific parameters</span>
<span class='no'>fit</span>$<span class='fu'>draws</span>(<span class='st'>"alpha"</span>)</div><div class='output co'>#&gt; # A draws_array: 1000 iterations, 4 chains, and 1 variables
#&gt; , , variable = alpha
#&gt; 
#&gt;          chain
#&gt; iteration     1     2    3    4
#&gt;         1 0.356 0.648 0.13 0.87
#&gt;         2 0.182 0.069 4.62 0.66
#&gt;         3 1.980 0.735 2.08 1.71
#&gt;         4 0.057 1.105 0.49 1.13
#&gt;         5 1.837 0.688 1.43 0.19
#&gt; 
#&gt; # ... with 995 more iterations</div><div class='input'><span class='no'>fit</span>$<span class='fu'>draws</span>(<span class='st'>"beta"</span>)  <span class='co'># selects entire vector beta</span></div><div class='output co'>#&gt; # A draws_array: 1000 iterations, 4 chains, and 6 variables
#&gt; , , variable = beta[1]
#&gt; 
#&gt;          chain
#&gt; iteration     1      2      3     4
#&gt;         1  0.18  0.039 -0.089 -0.13
#&gt;         2  0.67  2.356  0.155 -1.59
#&gt;         3 -1.15 -0.742  0.522 -0.16
#&gt;         4  2.02  0.857  0.777  0.40
#&gt;         5 -1.94  0.574 -0.108 -0.92
#&gt; 
#&gt; , , variable = beta[2]
#&gt; 
#&gt;          chain
#&gt; iteration      1     2     3     4
#&gt;         1 -0.865  1.23  1.11  0.40
#&gt;         2  0.356 -0.26  0.45 -0.85
#&gt;         3 -0.089 -1.28  0.40  0.53
#&gt;         4  0.618 -1.12 -2.42 -0.14
#&gt;         5 -0.835 -1.76 -1.15  0.46
#&gt; 
#&gt; , , variable = beta[3]
#&gt; 
#&gt;          chain
#&gt; iteration     1    2      3     4
#&gt;         1 -1.66 1.45  0.508  0.35
#&gt;         2 -0.84 2.21 -0.037 -0.22
#&gt;         3 -0.12 0.53  0.967 -1.26
#&gt;         4  0.44 0.76 -1.024 -1.01
#&gt;         5  0.73 1.67 -0.055  1.54
#&gt; 
#&gt; , , variable = beta[4]
#&gt; 
#&gt;          chain
#&gt; iteration     1     2     3     4
#&gt;         1  1.30  1.73 -1.77 -1.59
#&gt;         2  0.62 -1.17  2.14  1.41
#&gt;         3 -1.48 -0.71  1.12 -1.19
#&gt;         4 -2.58  0.15 -0.36  0.69
#&gt;         5  2.78 -1.25 -0.92  1.34
#&gt; 
#&gt; # ... with 995 more iterations, and 2 more variables</div><div class='input'><span class='no'>fit</span>$<span class='fu'>draws</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"alpha"</span>, <span class='st'>"beta[2]"</span>))</div><div class='output co'>#&gt; # A draws_array: 1000 iterations, 4 chains, and 2 variables
#&gt; , , variable = alpha
#&gt; 
#&gt;          chain
#&gt; iteration     1     2    3    4
#&gt;         1 0.356 0.648 0.13 0.87
#&gt;         2 0.182 0.069 4.62 0.66
#&gt;         3 1.980 0.735 2.08 1.71
#&gt;         4 0.057 1.105 0.49 1.13
#&gt;         5 1.837 0.688 1.43 0.19
#&gt; 
#&gt; , , variable = beta[2]
#&gt; 
#&gt;          chain
#&gt; iteration      1     2     3     4
#&gt;         1 -0.865  1.23  1.11  0.40
#&gt;         2  0.356 -0.26  0.45 -0.85
#&gt;         3 -0.089 -1.28  0.40  0.53
#&gt;         4  0.618 -1.12 -2.42 -0.14
#&gt;         5 -0.835 -1.76 -1.15  0.46
#&gt; 
#&gt; # ... with 995 more iterations</div><div class='input'># }

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Rok Češnovar.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


